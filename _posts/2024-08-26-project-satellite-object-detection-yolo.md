---
title: 【项目】卫星结构检测算法
date: 2024-04-01 10:45:15 +0800
categories: [项目, 目标特征识别分析算法]
tags: [YOLO, Pytorch, 数据增广, 小目标检测]
---

## 模型选型
近年来，基于深度学习的目标检测算法不断迭代发展，以其检测精度高、泛化性能好的优点在许多检测任务上都表现出优秀的性能。YOLOv5在满足精度要求的同时，有着算子兼容性好，易于边侧设备推理的特点，被广泛用于各种工业检测任务中。

### 预训练模型
YOLOv5有多个不同的变体，每个变体模型具有不同的大小和复杂度，在速度和准确度之间提供了不同的权衡，以适应不同的计算能力和实时性需求，根据其特征融合模块中卷积块的深度以及宽度的大小，按照模型参数量的大小分为x，n，l，m，s五种尺度，尺寸越大的模型拥有更高的精度，但同时更大的参数量会导致推理速度变慢，**YOLOv5m兼顾了检测精度与推理速度，适合作为卫星结构识别任务的基准模型。**

![YOLOv5不同变体对比图](assets/images/project-satellite-object-detection-yolo/YOLOv5不同变体对比图.png)

### 迁移学习
在选用YOLOv5m作为预训练模型的基础上，冻结预训练模型的一部分或全部参数，只对模型的一部分进行微调，可以有效地进行迁移学习。通过冻结底层的特征提取器（即主干网络，前10层），可以保留更多通用的特征，而只微调顶层的检测头，以适应新任务。如下图官方实验结果表明，冻结可以加快训练速度，但会略微降低最终的准确性。

![冻结对模型精度的影响图](assets/images/project-satellite-object-detection-yolo/冻结对模型精度的影响图.png)

## 存在问题
原生YOLOv5算法在卫星图像数据集上易出现**漏检、误检和推理速度不足以及小目标检测效果差**的问题，主要成因分析如下：
1. 太空中光照不稳定，空间卫星图像的亮度差距大，同时卫星结构有着多样性和复杂性的特点，数据的分布有着较大的差异；
2. 太空中的空间距离大，采集的卫星图像尺度不均，存在大量微小目标；
3. 卫星图像具有较高的分辨率，为2048×2048像素和1080×1440像素的tiff格式图像。

## 解决方案
针对以上问题，对模型的结构和损失计算方式、数据预处理以及结果后处理做了一定的改进。
### 数据预处理
- [空间光照模拟](/posts/project-satellite-object-detection-yolo-light-smi/)
- [尺度一致性增强](/posts/project-satellite-object-detection-yolo-scale/)

### 模型设计
- [损失函数](/posts/project-satellite-object-detection-yolo-loss/)
- [C3模块改进](/posts/project-satellite-object-detection-yolo-C3/)

### 结果后处理
- [结构一致性检验](/posts/project-satellite-object-detection-yolo-proir/)

## 总结
针对小目标问题，提出融合IoU与Wasserstein距离的边界框损失函数，弥补IoU损失对小目标衰减明显的缺陷，使得网络对于小目标样本的学习更加容易收敛；针对训练数据少导致误检严重，提出结构一致性检验的后处理方法，滤除了不合理的预测框，使得预测结果更加符合卫星的结构信息；针对实际部署的速度要求，提出C3-Faster模块，通过同时减少模型的FLOPs和内存访问量达到网络加速的目的。实验结果表明，所提出的方法在卫星数据集上表现良好，在实现更高检测精度的同时也提高了检测速度，符合实际太空探测的需要。